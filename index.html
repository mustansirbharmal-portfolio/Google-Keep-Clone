<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

<link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">

<title>Google Keep Notes</title>

<link rel="stylesheet" href="style.css" />

</head>

<body>

<div class="heading">
<h1><i class="fas fa-sticky-note"></i> Keep Notes</h1>
</div>

<div class="btn-div">
<button class="learn-more" class="add" id="add">

<span class="circle" aria-hidden="true">
<span class="icon arrow"><i class="fa-solid fa-angle-right bg-warning right-icon "  style=" color:#fff; display: grid; place-items: center;"></i></span>
</span>

<span class="button-text">Add note</span>

</button>
</div>

<!-- CODE TO BE INSERTED WHEN USER CLICKS

  <div class="operation">
<button class="edit"> <i class="fas fa-edit"></i> </button>
<button class="delete"> <i class="fas fa-trash-alt"></i></button>
</div> 

<div class="main"> </div>
<textarea class=""></textarea>
-->

<!-- SUBSCRIBE THAPA TECHNICAL YOUTUBE CHANNEL https://www.youtube.com/thapatechnical -->
<script src="script.js"></script>



<div id="chatbot-container" style="display: none; position: fixed; bottom: 100px; right: 20px; width: 350px; height: 500px; background: white; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); z-index: 1000;">
    <div style="background: #092AFC; color: white; padding: 10px; border-top-left-radius: 10px; border-top-right-radius: 10px; display: flex; justify-content: space-between; align-items: center;">
        <span>Chat with AI</span>
        <button onclick="toggleChatbot()" style="background: none; border: none; color: white; cursor: pointer;">âœ•</button>
    </div>
    <div id="chatbot-messages" style="height: 380px; overflow-y: auto; padding: 10px;"></div>
    <div style="padding: 10px; border-top: 1px solid #eee; display: flex;">
        <input type="text" id="chatbot-input" placeholder="Type your message..." style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px; margin-right: 8px;">
        <button onclick="sendMessage()" style="background: #092AFC; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer;">Send</button>
    </div>
</div>


<button onclick="toggleChatbot()" style="position: fixed; bottom: 20px; right: 20px; background: #092AFC; color: white; border: none; padding: 15px; border-radius: 50%; cursor: pointer; box-shadow: 0 0 10px rgba(0,0,0,0.1); z-index: 1000;">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
    </svg>
</button>

<script>
// Wait for DOM to be fully loaded
document.addEventListener('DOMContentLoaded', function() {
    const CHATBOT_SERVER_URL = 'http://localhost:5000';
    const chatInput = document.getElementById('chatbot-input');

    // Add event listener only if element exists
    if (chatInput) {
        chatInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    }

    window.toggleChatbot = function() {
        const container = document.getElementById('chatbot-container');
        if (container) {
            container.style.display = container.style.display === 'none' ? 'block' : 'none';
        }
    };

    window.appendMessage = function(message, isUser) {
        const messagesDiv = document.getElementById('chatbot-messages');
        if (!messagesDiv) return;

        const messageDiv = document.createElement('div');
        messageDiv.style.margin = '10px 0';
        messageDiv.style.padding = '10px';
        messageDiv.style.borderRadius = '10px';
        messageDiv.style.maxWidth = '80%';
        messageDiv.style.alignSelf = isUser ? 'flex-end' : 'flex-start';
        messageDiv.style.backgroundColor = isUser ? '#092AFC' : '#f0f0f0';
        messageDiv.style.color = isUser ? 'white' : 'black';
        messageDiv.style.marginLeft = isUser ? 'auto' : '0';
        messageDiv.textContent = message;
        messagesDiv.appendChild(messageDiv);
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    };

    window.sendMessage = function() {
        const input = document.getElementById('chatbot-input');
        if (!input) return;

        const message = input.value.trim();
        if (!message) return;

        appendMessage(message, true);
        input.value = '';

        // Send message to your Flask backend
        fetch(`${https://chatbot-embed-xf6v.onrender.com/}/ask`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ query: message })
        })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            if (data && data.response) {
                // Handle array of messages
                if (Array.isArray(data.response)) {
                    data.response.forEach(msg => appendMessage(msg, false));
                } else {
                    appendMessage(data.response, false);
                }
            } else {
                throw new Error('Invalid response format');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            appendMessage('Sorry, there was an error processing your request. Please try again.', false);
        });
    };
});
</script>
        



</body>
</html>
